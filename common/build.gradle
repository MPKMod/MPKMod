apply plugin: 'maven-publish'

group = $group
version = $version
archivesBaseName = $commonBaseName

dependencies {
    compileOnly 'org.apache.logging.log4j:log4j-api:3.0.0-beta2'
    compileOnly 'org.apache.logging.log4j:log4j-core:3.0.0-beta2'

    library "com.github.MPKMod.MPKNetworkAPI:common:main-SNAPSHOT"
}

compileJava.doLast {
    var classFile = new File("$temporaryDir${File.separator}classes.txt")
    classFile.createNewFile()

    classFile.text = sourceSets.main.output.classesDirs.asFileTree
            .files
            .collect {
                it.getAbsolutePath().substring(
                        sourceSets.main.output.classesDirs.asPath.length() + 1,
                        it.getAbsolutePath().length() - 6
                )
                        .replaceAll("[/\\\\]", ".")
            }.join(";")
}

java {
    withJavadocJar()
    withSourcesJar()
}

publishing {
    publications {
        maven(MavenPublication) {
            groupId $jitpackGroup
            artifactId $modBaseName + "-api"
            version $apiVersion
            from components.java
        }
    }
}